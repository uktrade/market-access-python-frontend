{% extends "barriers/edit/base.html" %}
{% load dates %}
{% load tz %}
{% block page_title %}{{ block.super }} - Monthly barrier update{% endblock %}

{% block back_link %}
    <a href="{% url 'barriers:barrier_detail' barrier.id %}" class="govuk-back-link ma-back-link">Back</a>
{% endblock %}

{% block page_content %}

    {% include 'partials/heading.html' with text='Previous barrier updates' %}
    {% timezone "Europe/London" %}
    <div class="event-list">
        {% for progress_update in progress_updates %}
            <div class="barrier-progress-update summary-group__list__value event-list__item">
                <div class="barrier-progress-update">
                    <div class="barrier-progress-update__section">
                        <h4 class="barrier-progress-update__section__heading">Delivery confidence</h4>
                        <p class="barrier-progress-update__section__text">
                            {% if progress_update.status is not empty %}
                                {{ progress_update.status_display|linebreaksbr }}
                            {% else %}
                                No monthly delivery confidence summary
                            {% endif %}
                        </p>
                    </div>
                    <div class="barrier-progress-update__section">
                        <h4 class="barrier-progress-update__section__heading">Current status</h4>
                        <p class="barrier-progress-update__section__text">
                            {% if progress_update.message is not empty %}
                                {{ progress_update.message|linebreaksbr }}
                            {% else %}
                                No monthly progress update
                            {% endif %}
                        </p>
                    </div>
                    <div class="barrier-progress-update__section">
                        <h4 class="barrier-progress-update__section__heading">Next steps</h4>
                        <p class="barrier-progress-update__section__text">
                            {% if progress_update.next_steps is not empty %}
                                {{ progress_update.next_steps|linebreaksbr }}
                            {% else %}
                                No monthly next steps
                            {% endif %}
                        </p>
                    </div>
                    <div class="barrier-progress-update__section">
                        <h4 class="barrier-progress-update__section__heading">
                            Date created: <span class="barrier-progress-update__section__date">
                                {{ progress_update.created_on|parse_iso|date:"j F Y" }} at {{ progress_update.created_on|parse_iso|date:"P (e)" }}
                            by </span> <span class="barrier-progress-update__section__user">{{ progress_update.created_by }}</span>
                        </h4>
                        {% if progress_update.created_on != progress_update.modified_on %}
                        <h4 class="barrier-progress-update__section__heading">
                            Date Modified: <span class="barrier-progress-update__section__date">
                                {{ progress_update.modified_on|parse_iso|date:"j F Y" }} at {{ progress_update.modified_on|parse_iso|date:"P (e)" }}
                            by </span> <span class="barrier-progress-update__section__user">{{ progress_update.modified_by }}</span>
                        </h4>
                        {% endif %}
                    </div>
                    <div class="barrier-progress-update__actions">
                        <a class="" href="{% url 'barriers:edit_progress_update' barrier.id progress_update.id %}">Edit</a>
                    </div>
                    {% if not barrier.archived %}
                        {% comment %} <a class="barrier-progress-update__section__edit" href="{% url 'barriers:edit_progress_update' barrier.id %}">Edit</a> {% endcomment %}
                    {% endif %}
                </div>
            </div>
            {% endfor %}
    </div>
        {% endtimezone %}

        <a class="govuk-button button--secondary" href="{% url 'barriers:barrier_detail' barrier.id %}">Back to barrier</a>


{% endblock %}
