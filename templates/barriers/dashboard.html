{% extends 'base.html' %}

{% block page_title %}{{ block.super }} - Homepage{% endblock %}

{% block body_script %}
    <script>
        ma.pages.index();
    </script>
{% endblock %}

{% block page_content %}
    {% include 'barriers/partials/dashboard_heading.html' %}


    <section>
        <ul class="ma-card-list">
            <li class="ma-card-list__item">
                <h3 class="saved-search__title"><a href="{% url 'barriers:find_a_barrier' %}?">My barriers</a></h3>
                <p><span class="ma-badge">6 barriers</span></p>
            </li>
            <li class="ma-card-list__item">
                <h3 class="saved-search__title"><a href="{% url 'barriers:find_a_barrier' %}?">Team barriers</a></h3>
                <p><span class="ma-badge">6 barriers</span></p>
            </li>
            <li class="ma-card-list__item">
                <h3 class="saved-search__title"><a href="{% url 'barriers:find_a_barrier' %}?">Draft barriers</a></h3>
                <p><span class="ma-badge">6 draft barriers</span></p>
            </li>
        </ul>
    </section>

    <section>
        <h2 class="saved-search-heading">{{ watchlists|length }}<span class="dashboard-results-header__title__caption"> saved search{{ watchlists|length|pluralize:"es" }}</span></h2>

        <ul class="ma-card-list">
            {% for watchlist in watchlists %}
                <li class="ma-card-list__item saved-search">
                    <h3 class="saved-search__title"><a href="{% url 'barriers:find_a_barrier' %}?{{ watchlist.querystring }}&edit={{ forloop.counter }}">{{ watchlist.name }}</a></h3>

                    <p><span class="ma-badge">6 barriers</span> in total</p>
                    {% if watchlist.filters %}
                        <ul class="saved-search__filter-list">
                            {% for name, value in watchlist.readable_filters.items %}
                                <li class="saved-search__filter-list-item">{{ value.readable_value|striptags }}</li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </li>
            {% endfor %}
        </ul>
    </section>

{% endblock %}
