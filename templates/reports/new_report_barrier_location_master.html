{% extends 'base.html' %}
{% load render_bundle from webpack_loader %}

{% block page_title %}{{ block.super }} - Add - {{ heading.text }}{% endblock %}

{% block body_script %}
    {{ block.super }}
    {% render_bundle 'main' 'js' 'REACT' %}
    <script>
        console.log("TEST")
        document.addEventListener("DOMContentLoaded", function (event) {
            console.log("RENDERING")
            ReactApp.renderLocationForm();
        })
    </script>
{% endblock %}

{% block page_content %}
    {% csrf_token %}
    <section class="restrict-width">
        <a href="{{ urls.back }}" class="govuk-back-link">Back</a>
        {% include 'partials/heading.html' with caption=heading.caption text=heading.text %}
        {% form_error_banner form %}

        {% csrf_token %} csrf

        <form action="" method="POST" id="location-form-container">

            {% csrf_token %}

            <h1>TEST</h1>

            <div class="{% form_group_classes form.errors %}">
                {% include "partials/forms/select_input.html" with field=form.location option_classes="location_option" %}
            </div>
            <div id="additional-location-fields">


                {% include "partials/forms/radio_input.html" with field=form.trade_direction %}

                {% comment %} {{ selected_admin_areas}}
                {{ location_form }}
                {{ selected_admin_areas_session }} {% endcomment %}
                {% comment %} {{ country_id }} - {{ form.location.value }} {% endcomment %}
                {% comment %} {{ country_id }}
                {{ trading_bloc }} {{ countries }} {{ trading_blocs }} {% endcomment %}
                {% if trading_bloc %}
                <div id="{{ form.caused_by_trading_bloc.name }}" class="{% form_group_classes form.errors %}">
                    {% include "partials/forms/radio_input.html" with field=form.caused_by_trading_bloc %}
                </div>
                {% endif %}

                {% if has_admin_areas %}
                <div class="govuk-form-group">
                    <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                        {{ form.fields.has_admin_areas.label }}
                    </legend>

                    {% form_field_error form "has_admin_areas" %}

                    <div class="govuk-radios has-admin-areas">
                    {% for choice_id, choice_label in form.fields.has_admin_areas.choices %}
                        <div class="govuk-radios__item">
                            <input class="govuk-radios__input"
                                   id="has-admin-areas-{{ choice_id }}"
                                   name="has_admin_areas"
                                   type="radio"
                                   value="{{ choice_id }}"
                                   {% if form.initial.has_admin_areas == choice_id %}checked="checked"{% endif %}>
                            <label class="govuk-label govuk-radios__label" for="has-admin-areas-{{ choice_id }}">
                                {{ choice_label }}
                            </label>
                        </div>
                    {% endfor %}
                    </div>
                </div>
                {% endif %}

                {% if has_admin_areas %}
                    <div class="{% form_group_classes form.errors %} govuk-form-group" id="admin-area-select-container">
                        <label class="govuk-label govuk-label--s" for="{{ form.admin_areas.name }}">
                            {{ form.admin_areas.label }}
                        </label>

                        {% form_field_error form "admin_areas" %}
    <p>

                            <select class="govuk-select govuk-!-width-full{% if form.errors %} govuk-select--error{% endif %}" id="{{ form.admin_areas.name }}" name="{{ form.admin_areas.name }}"{% if form.errors %} aria-describedby="{{ form.admin_areas.name }}-error"{% endif %}>
                                <option value selected>Select an admin area</option>
                                {% for area_id, area_name in form.fields.admin_areas.choices %}
                                <option class="admin_area_option" value="{{ area_id }}">{{ area_name }}</option>
                                {% endfor %}
                            </select>
    </p>
                        <input type="submit" name="add_admin_area" id="add_admin_area" value="Add admin area" class="govuk-button button--secondary">
                    </div>

                    {% if has_selected_admin_areas %}
                    <div class="selection-list restrict-width" id="selected-admin-areas-container">
                        <h3 class="selection-list__heading">Selected admin areas</h3>
                        <ul class="selection-list__list">
                            {% for area_id, area_name in selected_admin_areas %}
                            <li class="selection-list__list__item">
                                <span class="selection-list__list__item__number" data-number="{{ forloop.counter }}"></span>{{ area_name }}
                                {% comment %} <input type="submit" name="remove_admin_area" value="{{ area_id }}"> {% endcomment %}
                                <div class="selection-list__list__item__remove-form"><button type="submit" class="selection-list__list__item__remove-form__submit" name="remove_admin_area" value="{{ area_id }}">Remove</button></div>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                {% endif %}

</div>

            {% include 'reports/partials/new_report_submit_buttons.html' with has_next=has_next next_url=next_url %}
        </form>

	</section>


{% endblock %}
